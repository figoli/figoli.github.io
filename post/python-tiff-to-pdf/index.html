<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.24" />
  <meta name="author" content="Ryan Taylor">
  <meta name="description" content="Software Developer">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css" integrity="sha512-GGGNUPDhnG8LEAEDsjqYIQns+Gu8RBs4j5XGlxl7UfRaZBhCCm5jenJkeJL8uPuOXGqgl8/H1gjlWQDRjd3cUQ==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  

  <link rel="alternate" href="https://figoli.github.io/index.xml" type="application/rss+xml" title="Ryan Taylor&#39;s Blog">
  <link rel="feed" href="https://figoli.github.io/index.xml" type="application/rss+xml" title="Ryan Taylor&#39;s Blog">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://figoli.github.io/post/python-tiff-to-pdf/">

  

  <title>Building Simple Python Tool for Creating PDF of TIFF files | Ryan Taylor&#39;s Blog</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Ryan Taylor&#39;s Blog</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/resume/ryan-taylor-resume.html">
            
            <span>Resumé</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Building Simple Python Tool for Creating PDF of TIFF files</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2017-01-23 19:09:05 -0600 -0600" itemprop="datePublished">
      Mon, Jan 23, 2017
    </time>
  </span>

  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/python">python</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2ffigoli.github.io%2fpost%2fpython-tiff-to-pdf%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Building%20Simple%20Python%20Tool%20for%20Creating%20PDF%20of%20TIFF%20files&amp;url=https%3a%2f%2ffigoli.github.io%2fpost%2fpython-tiff-to-pdf%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2ffigoli.github.io%2fpost%2fpython-tiff-to-pdf%2f&amp;title=Building%20Simple%20Python%20Tool%20for%20Creating%20PDF%20of%20TIFF%20files"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2ffigoli.github.io%2fpost%2fpython-tiff-to-pdf%2f&amp;title=Building%20Simple%20Python%20Tool%20for%20Creating%20PDF%20of%20TIFF%20files"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Building%20Simple%20Python%20Tool%20for%20Creating%20PDF%20of%20TIFF%20files&amp;body=https%3a%2f%2ffigoli.github.io%2fpost%2fpython-tiff-to-pdf%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      

<p>Today, a friend asked about a tool for archiving a bunch of TIFF files by putting them all into a single PDF file.  This seemed like a good entry point for creating a simple, yet useful, tool with python.</p>

<p>As an added challenge, he didn’t have administrator access to his windows PC, so we came up with a solution to create a python development environment in windows without using any administrative privileges.  Then we used the environment to develop a simple python application to bundle tiff files into a single PDF.  And just to add a little icing to the cake, we used some python build tools to create a standalone exe file.</p>

<h2 id="step-1-setting-up-the-development-environment">Step 1. Setting Up the Development Environment</h2>

<ul>
<li>Download zip file of all the necessary files <a href="https://goo.gl/l9KCrE" target="_blank">https://goo.gl/l9KCrE</a>

<ul>
<li>This includes the python installation file, pycharm IDE, sample images, etc.</li>
</ul></li>
<li>Extract zip file (let’s say this was extracted to C:\Users\drwho\Downloads\pybundle</li>
<li>Create a virtual drive for that directory (let’s say T:) and install python:

<ul>
<li>open command line window, type the following:</li>
</ul></li>
</ul>

<pre><code>subst T:  C:\Users\drwho\Downloads\pybundle
T:
install_python.bat
</code></pre>

<p>Python is now installed with pip and the package img2pdf.  You can run this command to combine the sample images with the img2pdf command line tool that comes with the package:</p>

<pre><code>Scripts\img2pdf.exe -o ../output.pdf ../images/dir_1/dir_2/dir_3/CCITT_2.TIF ../images/dir_a/dir_b/dir_c/CCITT_1.TIF ../images/dir_x/dir_y/dir_z/CCITT_3.TIF
</code></pre>

<h2 id="step-2-using-img2pdf-library-to-create-tool">Step 2. Using img2pdf library to create tool</h2>

<p>Turns out that with the img2pdf library, it is a very few lines of code that are required to create the command line tool.  Here is the resulting code that creates a simple GUI with Tk and allows you to specify a root directory to search
for files:</p>

<pre><code class="language-python">import img2pdf, sys, os, time

if len(sys.argv) &gt; 1:
    image_directory = sys.argv[1]
    print &quot;I'm looking for TIFs in &quot;, image_directory
else:
    print &quot;Please tell me the directory to look in&quot;
    sys.exit()

image_files = []

for root, dirs, files in os.walk(image_directory):
    for file in files:
        if file.endswith(&quot;.tif&quot;) or file.endswith(&quot;.TIF&quot;):
             print&quot;Discovered this TIF: &quot;, os.path.join(root, file)
             image_files.append(os.path.join(root, file))

if image_files:
    output_file = time.strftime(&quot;%Y%m%d-%H%M%S&quot;) + &quot;.pdf&quot;
    print &quot;Putting all TIFs into &quot;, output_file
    pdf_bytes = img2pdf.convert(image_files)
    file = open(output_file,&quot;wb&quot;)
    file.write(pdf_bytes)
else:
    print &quot;Couldn't find any TIFs&quot;
</code></pre>

<p>For reference, here is what the sample input images directory structure looks like:
<img src="/img/tif2pdf-folders.png" alt="Example Directory Structure" /></p>

<h2 id="step-3-create-an-exe-file-using-pyinstaller">Step 3. Create an exe file using pyinstaller</h2>

<p>This is as simple as running (once pyinstaller is installed):</p>

<pre><code>pyinstaller --onefile --windowed tif2pdf.py #assuming the above python file is named &quot;tif2pdf.py&quot;
</code></pre>

<h2 id="summary">Summary</h2>

<p>I found this to be a simple use case that serves a real-world need, but is also relatively easy to implement.
I hope this can be useful to others, especially for anyone who is just starting to learn python.</p>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    

    
  </ul>
</nav>

</div>

<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Ryan Taylor &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

